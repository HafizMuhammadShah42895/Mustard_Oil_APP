<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Add New Product</title>

  <!-- Bootstrap -->
  <link rel="stylesheet"
        href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <!-- AOS Animation -->
  <link rel="stylesheet"
        href="https://unpkg.com/aos@2.3.1/dist/aos.css"/>
  <!-- Font Awesome -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"/>
  <!-- Animate.css -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

  <style>
    body {
      background: linear-gradient(to right, #d9e7ff, #fefefe);
      font-family: 'Segoe UI', sans-serif;
      padding-top: 60px;
    }

    .form-container {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(4px);
      border-radius: 20px;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      padding: 45px;
      max-width: 700px;
      margin: auto;
    }

    .form-container h2 {
      font-weight: 700;
      margin-bottom: 30px;
      text-align: center;
      color: #007bff;
    }

    .form-group label {
      font-weight: 500;
      margin-bottom: 6px;
    }

    .form-control,
    .custom-file-input {
      border-radius: 10px;
      transition: 0.3s ease-in-out;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
    }

    .form-control:focus,
    .custom-file-input:focus {
      box-shadow: 0 0 0 0.15rem rgba(0, 123, 255, 0.25);
    }

    .custom-file-label {
      border-radius: 10px;
    }

    .btn-rounded {
      border-radius: 25px;
      padding: 10px 24px;
      font-weight: 500;
      transition: all 0.3s ease-in-out;
    }

    .btn-rounded:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.1);
    }

    .btn-primary   { background-color: #007bff; border: none; }
    .btn-secondary { background-color: #6c757d; border: none; }
    .btn-warning   { background-color: #ffc107; border: none; color: #333; }

    /* error helper */
    .is-invalid { border-color: #dc3545 !important; }

    @media (max-width: 576px) {
      .form-container { padding: 30px 20px; }
    }
  </style>
</head>
<body>

<div class="container">
  <div class="form-container animate__animated animate__fadeInUp" data-aos="zoom-in">
    <h2 class="animate__animated animate__fadeInDown">
      <i class="fas fa-box-open"></i> Add New Product
    </h2>

    <!-- Form -->
    <form method="POST" enctype="multipart/form-data">
      <!-- Product Name -->
      <div class="form-group" data-aos="fade-up" data-aos-delay="100">
        <label><i class="fas fa-tag"></i> Product Name</label>
        <input type="text" name="name" class="form-control"
               placeholder="Enter product name" required>
        <div class="invalid-feedback" id="name-error"></div>
      </div>

      <!-- Price -->
      <div class="form-group" data-aos="fade-up" data-aos-delay="200">
        <label><i class="fas fa-rupee-sign"></i> Price (₨)</label>
        <input type="number" step="0.01" name="price" class="form-control"
               placeholder="e.g., 600" required>
        <div class="invalid-feedback" id="price-error"></div>
      </div>

      <!-- Description -->
      <div class="form-group" data-aos="fade-up" data-aos-delay="300">
        <label><i class="fas fa-align-left"></i> Description</label>
        <textarea name="description" class="form-control" rows="4"
                  placeholder="Enter product details" required></textarea>
        <div class="invalid-feedback" id="desc-error"></div>
      </div>

      <!-- Image -->
      <div class="form-group" data-aos="fade-up" data-aos-delay="400">
        <label><i class="fas fa-image"></i> Product Image</label>
        <div class="custom-file">
          <input type="file" name="image" class="custom-file-input"
                 id="productImage" required>
          <label class="custom-file-label" for="productImage">Choose file</label>
        </div>
        <div class="invalid-feedback" id="image-error"></div>
      </div>

      <!-- Buttons -->
      <div class="text-center mt-4" data-aos="fade-up" data-aos-delay="500">
        <button type="submit" class="btn btn-primary btn-rounded mr-2">
          <i class="fas fa-plus-circle"></i> Add Product
        </button>
        <a href="{{ url_for('admin_bp.admin_dashboard') }}"
           class="btn btn-secondary btn-rounded mr-2">
          <i class="fas fa-arrow-left"></i> Back
        </a>
        <button type="reset" class="btn btn-warning btn-rounded">
          <i class="fas fa-undo-alt"></i> Reset
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

<script>
  // Init AOS
  AOS.init({ duration: 1000 });

  // Show selected filename
  $(".custom-file-input").on("change", function () {
    const fileName = $(this).val().split("\\").pop();
    $(this).next(".custom-file-label").addClass("selected").html(fileName);
  });

  // Validation on submit
  $("form").on("submit", function (e) {
    let valid = true;

    // Clear previous errors
    $(".is-invalid").removeClass("is-invalid");
    $(".invalid-feedback").text("");

    const name = $("input[name='name']").val().trim();
    const price = parseFloat($("input[name='price']").val());
    const desc = $("textarea[name='description']").val().trim();
    const file = $("input[name='image']").val();

    // 1) Name validation
    if (name.length === 0 || name.length > 25) {
      $("input[name='name']").addClass("is-invalid");
      $("#name-error").text("Product name must be 1‑25 characters.");
      valid = false;
    }

    // 2) Price validation
    if (isNaN(price) || price <= 0) {
      $("input[name='price']").addClass("is-invalid");
      $("#price-error").text("Enter a valid price greater than 0.");
      valid = false;
    }

    // 3) Description validation
    if (desc.length === 0 || desc.length > 200) {
      $("textarea[name='description']").addClass("is-invalid");
      $("#desc-error").text("Description must be 1‑200 characters.");
      valid = false;
    }

    // 4) Image validation
    if (file.length === 0 || !/\.(jpg|jpeg|png|gif)$/i.test(file)) {
      $("input[name='image']").addClass("is-invalid");
      $("#image-error").text("Upload a valid image file (jpg, jpeg, png, gif).");
      valid = false;
    }

    // Cancel submit if invalid
    if (!valid) {
      e.preventDefault();
    }
  });
</script>
</body>
</html>
